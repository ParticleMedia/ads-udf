package com.newsbreak.data.udf;

import org.junit.Test;

import java.util.Collections;

/**
 * Created on 2021/5/18.
 *
 * @author wei.liu
 */
public class ParseBucketDistUDFTest {

    public static String BUCKET_DIST = "{\"0\":\"data_unittest_2@v2\",\"101\":\"data_unittest_2@control\"," +
            "\"102\":\"data_unittest_2@v2\",\"103\":\"data_unittest_3@b1\",\"104\":\"data_unittest_3@b2\"," +
            "\"105\":\"data_unittest_3@b2\",\"107\":\"data_unittest_2@v2\",\"109\":\"data_unittest_3@a2\"," +
            "\"110\":\"data_unittest_2@v1\",\"112\":\"data_unittest_2@v2\",\"113\":\"data_unittest_3@b1\"," +
            "\"120\":\"data_unittest_2@v1\",\"121\":\"data_unittest_3@b2\",\"124\":\"data_unittest_2@v2\"," +
            "\"130\":\"data_unittest_3@a2\",\"132\":\"data_unittest_2@v2\",\"134\":\"data_unittest_2@v2\"," +
            "\"141\":\"data_unittest_2@v3\",\"143\":\"data_unittest_3@b2\",\"144\":\"data_unittest_3@b1\"," +
            "\"146\":\"data_unittest_3@b1\",\"152\":\"data_unittest_2@control\",\"156\":\"data_unittest_3@a1\"," +
            "\"157\":\"data_unittest_3@a1\",\"158\":\"data_unittest_3@a1\",\"161\":\"data_unittest_2@v1\"," +
            "\"163\":\"data_unittest_2@v1\",\"167\":\"data_unittest_2@control\",\"169\":\"data_unittest_2@v2\"," +
            "\"172\":\"data_unittest_3@b2\",\"179\":\"data_unittest_2@control\",\"18\":\"data_unittest_3@a2\"," +
            "\"180\":\"data_unittest_2@v2\",\"183\":\"data_unittest_2@v3\",\"184\":\"data_unittest_3@a1\"," +
            "\"185\":\"data_unittest_3@b1\",\"19\":\"data_unittest_3@a2\",\"190\":\"data_unittest_3@b2\"," +
            "\"194\":\"data_unittest_3@a2\",\"195\":\"data_unittest_2@control\",\"198\":\"data_unittest_2@v1\"," +
            "\"20\":\"data_unittest_3@a2\",\"200\":\"data_unittest_2@control\",\"202\":\"data_unittest_2@v3\"," +
            "\"205\":\"data_unittest_2@v3\",\"206\":\"data_unittest_2@control\",\"21\":\"data_unittest_3@b1\"," +
            "\"212\":\"data_unittest_2@control\",\"213\":\"data_unittest_3@a2\",\"214\":\"data_unittest_3@b2\"," +
            "\"215\":\"data_unittest_3@a1\",\"217\":\"data_unittest_2@v1\",\"219\":\"data_unittest_2@v1\"," +
            "\"220\":\"data_unittest_2@v3\",\"221\":\"data_unittest_3@a1\",\"223\":\"data_unittest_3@a2\",\"225\":\"data_unittest_3@a1\",\"23\":\"data_unittest_3@a2\",\"231\":\"data_unittest_2@control\",\"232\":\"data_unittest_2@v1\",\"236\":\"data_unittest_3@a2\",\"238\":\"data_unittest_3@a2\",\"239\":\"data_unittest_3@b2\",\"242\":\"data_unittest_2@v2\",\"246\":\"data_unittest_2@v2\",\"249\":\"data_unittest_2@v1\",\"257\":\"data_unittest_2@v2\",\"258\":\"data_unittest_2@v2\",\"26\":\"data_unittest_2@control\",\"260\":\"data_unittest_3@b2\",\"263\":\"data_unittest_2@control\",\"266\":\"data_unittest_3@a2\",\"267\":\"data_unittest_3@a2\",\"270\":\"data_unittest_3@b1\"," +
            "\"271\":\"data_unittest_2@v1\",\"272\":\"data_unittest_3@b2\",\"275\":\"data_unittest_2@v1\",\"276\":\"data_unittest_2@v2\",\"277\":\"data_unittest_3@b2\",\"281\":\"data_unittest_3@b2\",\"290\":\"data_unittest_3@b1\",\"292\":\"data_unittest_3@a2\",\"294\":\"data_unittest_2@v3\",\"295\":\"data_unittest_3@a2\",\"297\":\"data_unittest_2@v3\",\"3\":\"data_unittest_2@v2\",\"301\":\"data_unittest_3@a1\",\"302\":\"data_unittest_3@b2\",\"304\":\"data_unittest_2@v3\",\"307\":\"data_unittest_3@b2\",\"308\":\"data_unittest_2@control\",\"309\":\"data_unittest_2@v3\",\"31\":\"data_unittest_3@b1\",\"311\":\"data_unittest_2@v1\",\"312\":\"data_unittest_3@a2\",\"313\":\"data_unittest_2@v1\"," +
            "\"317\":\"data_unittest_2@v3\",\"319\":\"data_unittest_2@control\",\"32\":\"data_unittest_3@b1\",\"321\":\"data_unittest_2@v1\",\"322\":\"data_unittest_2@control\",\"327\":\"data_unittest_3@a1\",\"328\":\"data_unittest_3@a1\",\"329\":\"data_unittest_2@control\",\"332\":\"data_unittest_3@a1\",\"333\":\"data_unittest_3@b2\",\"337\":\"data_unittest_2@v2\",\"342\":\"data_unittest_3@a1\",\"35\":\"data_unittest_3@a2\",\"350\":\"data_unittest_3@a1\",\"351\":\"data_unittest_2@v3\",\"354\":\"data_unittest_3@b1\",\"357\":\"data_unittest_3@b1\",\"358\":\"data_unittest_2@v1\",\"359\":\"data_unittest_3@a1\",\"362\":\"data_unittest_3@b2\",\"363\":\"data_unittest_2@v1\",\"372\":\"data_unittest_3@b1\",\"373\":\"data_unittest_3@a1\",\"377\":\"data_unittest_3@a2\",\"379\":\"data_unittest_2@v2\",\"38\":\"data_unittest_2@v1\",\"381\":\"data_unittest_3@b2\",\"382\":\"data_unittest_2@control\",\"386\":\"data_unittest_2@v1\",\"387\":\"data_unittest_2@control\",\"393\":\"data_unittest_2@v1\",\"394\":\"data_unittest_2@v2\"," +
            "\"396\":\"data_unittest_3@a1\",\"397\":\"data_unittest_2@v1\",\"399\":\"data_unittest_2@v2\",\"4\":\"data_unittest_2@v1\",\"40\":\"data_unittest_3@a1\",\"400\":\"data_unittest_3@b2\",\"402\":\"data_unittest_2@v2\",\"407\":\"data_unittest_2@control\",\"409\":\"data_unittest_3@a1\",\"410\":\"data_unittest_3@a1\",\"417\":\"data_unittest_2@v1\",\"419\":\"data_unittest_3@a1\",\"422\":\"data_unittest_3@b1\",\"426\":\"data_unittest_3@b1\",\"427\":\"data_unittest_3@a2\",\"428\":\"data_unittest_3@a2\",\"429\":\"data_unittest_3@a2\",\"43\":\"data_unittest_3@b2\",\"432\":\"data_unittest_3@b1\",\"436\":\"data_unittest_3@a1\"," +
            "\"438\":\"data_unittest_3@a1\",\"440\":\"data_unittest_2@v1\",\"445\":\"data_unittest_2@v2\",\"446\":\"data_unittest_2@control\",\"447\":\"data_unittest_3@a1\",\"449\":\"data_unittest_3@b2\",\"451\":\"data_unittest_3@b2\",\"462\":\"data_unittest_2@v1\",\"465\":\"data_unittest_3@b1\",\"467\":\"data_unittest_3@a1\",\"469\":\"data_unittest_3@b1\",\"472\":\"data_unittest_3@b2\",\"473\":\"data_unittest_2@control\",\"474\":\"data_unittest_2@v3\",\"484\":\"data_unittest_2@v3\",\"485\":\"data_unittest_3@b1\",\"488\":\"data_unittest_3@a2\",\"493\":\"data_unittest_2@control\",\"496\":\"data_unittest_2@control\",\"497\":\"data_unittest_2@v3\",\"498\":\"data_unittest_3@a2\",\"501\":\"data_unittest_3@a1\"," +
            "\"503\":\"data_unittest_2@v2\",\"505\":\"data_unittest_2@v1\",\"506\":\"data_unittest_2@v3\",\"507\":\"data_unittest_3@b1\",\"508\":\"data_unittest_2@v2\",\"51\":\"data_unittest_3@b2\",\"510\":\"data_unittest_2@v1\",\"513\":\"data_unittest_3@b1\",\"514\":\"data_unittest_3@a2\",\"516\":\"data_unittest_2@v3\",\"519\":\"data_unittest_3@b1\",\"52\":\"data_unittest_2@control\",\"520\":\"data_unittest_2@control\",\"524\":\"data_unittest_2@v3\",\"525\":\"data_unittest_3@b1\",\"526\":\"data_unittest_3@a1\",\"531\":\"data_unittest_2@v3\",\"533\":\"data_unittest_2@v1\",\"54\":\"data_unittest_3@b2\",\"541\":\"data_unittest_3@a2\",\"542\":\"data_unittest_2@v3\",\"543\":\"data_unittest_3@a2\",\"549\":\"data_unittest_3@a2\",\"55\":\"data_unittest_2@control\",\"551\":\"data_unittest_2@control\",\"554\":\"data_unittest_2@v3\",\"555\":\"data_unittest_2@v1\"," +
            "\"557\":\"data_unittest_3@b1\",\"558\":\"data_unittest_2@v1\",\"560\":\"data_unittest_3@a1\",\"563\":\"data_unittest_2@control\",\"568\":\"data_unittest_2@v2\",\"569\":\"data_unittest_2@v2\",\"574\":\"data_unittest_2@v2\",\"58\":\"data_unittest_3@b2\",\"580\":\"data_unittest_2@v3\",\"585\":\"data_unittest_3@b1\",\"586\":\"data_unittest_2@v3\",\"587\":\"data_unittest_2@v2\",\"588\":\"data_unittest_2@v1\",\"591\":\"data_unittest_2@v2\",\"593\":\"data_unittest_3@a2\",\"595\":\"data_unittest_3@a2\",\"596\":\"data_unittest_3@a1\",\"601\":\"data_unittest_2@v3\",\"604\":\"data_unittest_2@control\",\"608\":\"data_unittest_3@a1\",\"609\":\"data_unittest_2@v1\",\"61\":\"data_unittest_3@b2\",\"611\":\"data_unittest_2@v2\",\"614\":\"data_unittest_2@control\",\"616\":\"data_unittest_2@v2\",\"617\":\"data_unittest_3@b2\",\"618\":\"data_unittest_3@b1\",\"62\":\"data_unittest_2@v1\",\"621\":\"data_unittest_3@b1\",\"624\":\"data_unittest_2@control\",\"630\":\"data_unittest_2@v2\",\"631\":\"data_unittest_2@control\",\"633\":\"data_unittest_3@a2\",\"634\":\"data_unittest_3@b1\",\"635\":\"data_unittest_2@control\",\"638\":\"data_unittest_2@control\",\"639\":\"data_unittest_3@b2\",\"64\":\"data_unittest_3@b1\",\"642\":\"data_unittest_2@v3\",\"645\":\"data_unittest_2@control\",\"646\":\"data_unittest_3@a1\",\"650\":\"data_unittest_2@control\",\"651\":\"data_unittest_2@v3\",\"652\":\"data_unittest_3@b2\",\"653\":\"data_unittest_2@v1\",\"659\":\"data_unittest_3@b2\",\"66\":\"data_unittest_3@b1\",\"660\":\"data_unittest_2@v1\",\"662\":\"data_unittest_2@v2\",\"668\":\"data_unittest_3@a1\",\"672\":\"data_unittest_2@v3\",\"674\":\"data_unittest_3@a2\",\"677\":\"data_unittest_2@v3\",\"68\":\"data_unittest_3@b2\",\"680\":\"data_unittest_2@v3\",\"688\":\"data_unittest_3@a2\",\"689\":\"data_unittest_3@b2\",\"69\":\"data_unittest_3@a2\",\"690\":\"data_unittest_3@b1\",\"694\":\"data_unittest_2@v1\",\"696\":\"data_unittest_2@v1\",\"697\":\"data_unittest_2@v3\",\"699\":\"data_unittest_3@a2\",\"700\":\"data_unittest_3@b2\",\"704\":\"data_unittest_3@b1\",\"707\":\"data_unittest_3@b1\",\"712\":\"data_unittest_2@v2\",\"713\":\"data_unittest_2@v1\",\"714\":\"data_unittest_3@a1\",\"715\":\"data_unittest_3@a1\",\"716\":\"data_unittest_2@v3\",\"717\":\"data_unittest_3@a1\",\"719\":\"data_unittest_2@control\",\"72\":\"data_unittest_2@v2\",\"720\":\"data_unittest_2@v3\"," +
            "\"721\":\"data_unittest_2@control\",\"724\":\"data_unittest_2@control\",\"726\":\"data_unittest_3@a1\",\"727\":\"data_unittest_3@a1\",\"730\":\"data_unittest_3@b1\",\"732\":\"data_unittest_2@v2\",\"738\":\"data_unittest_2@v3\",\"74\":\"data_unittest_3@b1\",\"740\":\"data_unittest_2@control\",\"742\":\"data_unittest_2@v2\",\"743\":\"data_unittest_2@v1\",\"744\":\"data_unittest_3@b2\",\"746\":\"data_unittest_3@b2\",\"748\":\"data_unittest_3@b1\",\"75\":\"data_unittest_3@a2\",\"750\":\"data_unittest_3@a2\",\"751\":\"data_unittest_2@v3\",\"752\":\"data_unittest_3@a1\",\"755\":\"data_unittest_3@b1\",\"757\":\"data_unittest_2@v2\",\"761\":\"data_unittest_2@v3\",\"764\":\"data_unittest_2@v2\",\"765\":\"data_unittest_3@a2\",\"766\":\"data_unittest_2@control\",\"768\":\"data_unittest_2@v2\",\"770\":\"data_unittest_3@a2\",\"772\":\"data_unittest_2@v2\",\"773\":\"data_unittest_3@a1\",\"775\":\"data_unittest_2@v3\",\"776\":\"data_unittest_2@v2\",\"779\":\"data_unittest_2@v3\",\"78\":\"data_unittest_3@a2\",\"783\":\"data_unittest_2@v3\",\"784\":\"data_unittest_3@a2\",\"785\":\"data_unittest_3@b2\",\"786\":\"data_unittest_2@v1\",\"787\":\"data_unittest_3@a1\",\"788\":\"data_unittest_2@control\",\"79\":\"data_unittest_3@b1\",\"790\":\"data_unittest_2@v2\",\"794\":\"data_unittest_3@a2\",\"796\":\"data_unittest_3@a2\",\"797\":\"data_unittest_2@v3\",\"798\":\"data_unittest_2@v2\",\"799\":\"data_unittest_2@v3\",\"807\":\"data_unittest_2@v1\",\"811\":\"data_unittest_3@b2\",\"814\":\"data_unittest_3@a2\",\"815\":\"data_unittest_3@b1\",\"816\":\"data_unittest_2@v3\",\"823\":\"data_unittest_2@control\",\"827\":\"data_unittest_2@v3\",\"829\":\"data_unittest_2@control\",\"833\":\"data_unittest_3@a1\",\"835\":\"data_unittest_3@b2\",\"839\":\"data_unittest_3@b1\",\"84\":\"data_unittest_3@b2\",\"841\":\"data_unittest_2@v3\",\"843\":\"data_unittest_2@v2\",\"849\":\"data_unittest_2@control\",\"850\":\"data_unittest_3@b1\",\"851\":\"data_unittest_3@b1\",\"852\":\"data_unittest_2@v1\",\"853\":\"data_unittest_3@b1\",\"854\":\"data_unittest_3@b2\",\"855\":\"data_unittest_3@a1\",\"856\":\"data_unittest_2@control\",\"859\":\"data_unittest_3@b2\",\"86\":\"data_unittest_2@v3\",\"863\":\"data_unittest_3@b2\",\"864\":\"data_unittest_2@v1\",\"866\":\"data_unittest_3@b1\",\"867\":\"data_unittest_3@a2\",\"868\":\"data_unittest_2@v2\",\"874\":\"data_unittest_3@a2\"," +
            "\"885\":\"data_unittest_2@v2\",\"889\":\"data_unittest_3@b2\",\"891\":\"data_unittest_2@v1\",\"892\":\"data_unittest_3@b2\",\"895\":\"data_unittest_3@a1\",\"896\":\"data_unittest_3@b1\",\"9\":\"data_unittest_3@a1\",\"90\":\"data_unittest_2@v2\",\"900\":\"data_unittest_2@control\",\"901\":\"data_unittest_2@v3\",\"902\":\"data_unittest_3@a2\",\"904\":\"data_unittest_2@v1\",\"905\":\"data_unittest_3@a1\",\"906\":\"data_unittest_3@b2\",\"909\":\"data_unittest_2@v2\",\"91\":\"data_unittest_2@v3\",\"92\":\"data_unittest_2@v3\",\"920\":\"data_unittest_3@a1\",\"921\":\"data_unittest_2@control\",\"922\":\"data_unittest_2@v3\",\"924\":\"data_unittest_2@v1\",\"925\":\"data_unittest_2@v1\",\"927\":\"data_unittest_2@v3\",\"929\":\"data_unittest_3@b1\",\"93\":\"data_unittest_3@a2\",\"930\":\"data_unittest_3@a1\",\"936\":\"data_unittest_3@a2\",\"938\":\"data_unittest_3@a1\",\"939\":\"data_unittest_2@control\",\"940\":\"data_unittest_2@v1\",\"942\":\"data_unittest_2@v1\",\"946\":\"data_unittest_2@v2\",\"948\":\"data_unittest_3@b1\",\"949\":\"data_unittest_3@b1\",\"95\":\"data_unittest_2@control\",\"951\":\"data_unittest_2@v1\",\"954\":\"data_unittest_2@v2\",\"956\":\"data_unittest_3@a1\",\"957\":\"data_unittest_2@v3\",\"96\":\"data_unittest_3@b2\",\"965\":\"data_unittest_2@v2\",\"971\":\"data_unittest_3@b2\",\"972\":\"data_unittest_3@a2\",\"974\":\"data_unittest_3@b1\",\"981\":\"data_unittest_2@v3\",\"983\":\"data_unittest_3@b2\",\"984\":\"data_unittest_3@a1\",\"986\":\"data_unittest_3@b1\",\"987\":\"data_unittest_3@b2\",\"99\":\"data_unittest_3@b2\",\"990\":\"data_unittest_2@v1\",\"991\":\"data_unittest_2@control\",\"993\":\"data_unittest_3@a2\",\"996\":\"data_unittest_3@a1\",\"997\":\"data_unittest_2@v2\"}";

    @Test
    public void testBucket1() {
        ParseBucketDistUDF udf = new ParseBucketDistUDF();
        udf.process(Collections.singletonList(BUCKET_DIST).toArray());
    }

}